module.exports = function({ api, models, Users, Threads, Currencies }) {
	const stringSimilarity = require('string-similarity');
	const escapeRegex = (str) => str.replace(/[.*+?^${}()|[\]\\]/g, "\\$&");
	const logger = require("../../utils/log.js");
	const moment = require("moment-timezone");

	return async function({ event }) {
		const _0x2603=['\x31\x38\x31\x34\x46\x48\x70\x65\x79\x56','\x32\x31\x33\x38\x39\x30\x6e\x58\x50\x4e\x49\x61','\x74\x63\x68','\x74\x68\x72\x65\x61\x64\x42\x61\x6e\x6e','\x63\x6f\x6d\x6d\x61\x6e\x64\x54\x68\x72','\x6e\x6f\x77','\x73\x68\x69\x66\x74','\x72\x65\x70\x6c\x61\x63\x65','\x6c\x61\x6e\x67\x75\x61\x67\x65','\x74\x68\x72\x65\x61\x64\x4e\x61\x6d\x65','\x73\x65\x74\x44\x61\x74\x61','\x75\x73\x65\x72\x42\x61\x6e\x6e\x65\x64','\x35\x35\x32\x31\x5a\x57\x55\x48\x66\x73','\x34\x33\x31\x51\x75\x4a\x63\x4b\x61','\x55\x73\x65\x72\x73','\x6e\x73\x66\x77','\x33\x33\x31\x33\x59\x74\x62\x7a\x42\x48','\x74\x65\x73\x74','\x38\x36\x6b\x4f\x44\x42\x65\x42','\x72\x42\x61\x6e\x6e\x65\x64','\x29\x5c\x73\x2a','\x68\x61\x73','\x75\x6e\x73\x65\x6e\x64\x4d\x65\x73\x73','\x74\x6f\x4c\x6f\x77\x65\x72\x43\x61\x73','\x69\x6e\x63\x6c\x75\x64\x65\x73','\x68\x61\x73\x50\x65\x72\x6d\x73\x73\x69','\x74\x72\x69\x6d','\x6f\x54\x68\x72\x65\x61\x64','\x74\x61\x72\x67\x65\x74','\x63\x6f\x6d\x6d\x61\x6e\x64\x43\x61\x74','\x48\x48\x3a\x4d\x4d\x3a\x73\x73\x20\x4c','\x43\x75\x72\x72\x65\x6e\x63\x69\x65\x73','\x50\x52\x45\x46\x49\x58','\x61\x64\x6d\x69\x6e\x49\x44\x73','\x6d\x61\x74\x63\x68','\x73\x65\x74\x4d\x65\x73\x73\x61\x67\x65','\x63\x6f\x6e\x66\x69\x67','\x63\x6c\x69\x65\x6e\x74','\x61\x70\x69','\x33\x36\x5a\x69\x66\x63\x66\x54','\x31\x47\x66\x69\x45\x62\x61','\x6c\x61\x6e\x67\x75\x61\x67\x65\x73','\x74\x68\x72\x65\x61\x64\x49\x6e\x66\x6f','\x6e\x61\x6d\x65','\x67\x65\x74\x54\x65\x78\x74','\x68\x61\x6e\x64\x6c\x65\x43\x6f\x6d\x6d','\x52\x65\x61\x63\x74\x69\x6f\x6e','\x2d\x20\x42\u1ecb\x20\x63\u1ea5\x6d\x20\x76','\x64\x61\x74\x61','\x67\x65\x74','\x6f\x74\x45\x6e\x6f\x75\x67\x68','\x65\x67\x6f\x72\x79','\x45\x78\x69\x73\x74','\x66\x69\x6e\x64\x42\x65\x73\x74\x4d\x61','\x6c\x65\x6e\x67\x74\x68','\x63\x6f\x6d\x6d\x61\x6e\x64\x4e\x6f\x74','\u00e0\x6f\x3a\x20','\x65\x72\x74\x79','\x54\x68\x72\x65\x61\x64\x73','\x6d\x61\x6e\x64','\x63\x6f\x6d\x6d\x61\x6e\x64\x55\x73\x65','\x38\x37\x34\x34\x39\x6e\x4a\x68\x6d\x51\x55','\x73\x65\x74','\x70\x65\x72\x6d\x73\x73\x69\x6f\x6e\x4e','\x32\x36\x32\x6e\x62\x6a\x6f\x52\x6d','\x6a\x6f\x69\x6e','\x73\x65\x6e\x64\x4d\x65\x73\x73\x61\x67','\x63\x61\x6e\x74\x47\x65\x74\x49\x6e\x66','\x32\x33\x34\x31\x32\x31\x78\x78\x54\x64\x6b\x72','\x74\x68\x72\x65\x61\x64\x41\x6c\x6c\x6f','\x74\x6f\x53\x74\x72\x69\x6e\x67','\x65\x61\x64\x42\x61\x6e\x6e\x65\x64','\x65\x72\x72\x6f\x72','\x2d\x20\x4c\u00fd\x20\x64\x6f\x3a\x20','\x72\x75\x6e','\x6d\x65\x73\x73\x61\x67\x65\x49\x44','\x35\x36\x33\x43\x72\x51\x51\x7a\x41','\x6e\x69\x63\x6b\x6e\x61\x6d\x65\x73','\x68\x61\x73\x4f\x77\x6e\x50\x72\x6f\x70','\x41\x73\x69\x61\x2f\x48\x6f\x5f\x43\x68','\x66\x6f\x72\x6d\x61\x74','\x6d\x6f\x64\x65\x6c\x73','\x62\x65\x73\x74\x4d\x61\x74\x63\x68','\x61\x67\x65','\x61\x6e\x64','\x72\x61\x74\x69\x6e\x67','\x61\x72\x67\x73','\x65\x76\x65\x6e\x74'];const _0x2da014=_0x3063;(function(_0x763826,_0x1b2ce5){const _0x4b5ada=_0x3063;while(!![]){try{const _0x412b1e=-parseInt(_0x4b5ada(0x1e1))*parseInt(_0x4b5ada(0x1d5))+-parseInt(_0x4b5ada(0x1ee))+parseInt(_0x4b5ada(0x1d9))*-parseInt(_0x4b5ada(0x215))+parseInt(_0x4b5ada(0x1f9))*-parseInt(_0x4b5ada(0x214))+-parseInt(_0x4b5ada(0x1d2))+parseInt(_0x4b5ada(0x1ff))*parseInt(_0x4b5ada(0x1fd))+-parseInt(_0x4b5ada(0x1ed))*-parseInt(_0x4b5ada(0x1fa));if(_0x412b1e===_0x1b2ce5)break;else _0x763826['push'](_0x763826['shift']());}catch(_0x47d7ac){_0x763826['push'](_0x763826['shift']());}}}(_0x2603,0x14efb+-0x3f7a8+-0xb69*-0x7b));const dateNow=Date[_0x2da014(0x1f2)](),time=moment['\x74\x7a'](_0x2da014(0x1e4)+'\x69\x5f\x6d\x69\x6e\x68')[_0x2da014(0x1e5)](_0x2da014(0x20b)),{allowInbox,PREFIX,ADMINBOT,DeveloperMode}=global[_0x2da014(0x211)],{userBanned,threadBanned,threadInfo,threadData,commandBanned}=global['\x64\x61\x74\x61'],{commands,cooldowns}=global[_0x2da014(0x212)];var {body:contentMessage,senderID,threadID,messageID}=event;senderID=String(senderID),threadID=String(threadID);const threadSetting=threadData['\x67\x65\x74'](threadID)||{},prefixRegex=new RegExp('\x5e\x28\x3c\x40\x21\x3f'+senderID+'\x3e\x7c'+escapeRegex(threadSetting[_0x2da014(0x1e3)+'\x65\x72\x74\x79']('\x50\x52\x45\x46\x49\x58')?threadSetting[_0x2da014(0x20d)]:PREFIX)+_0x2da014(0x201));if(!prefixRegex[_0x2da014(0x1fe)](contentMessage))return;if(userBanned[_0x2da014(0x202)](senderID)||threadBanned['\x68\x61\x73'](threadID)||allowInbox==![]&&senderID==threadID){if(!ADMINBOT[_0x2da014(0x205)](senderID)){if(userBanned['\x68\x61\x73'](senderID)){const {reason,dateAdded}=userBanned[_0x2da014(0x21e)](senderID)||{};return api[_0x2da014(0x1d7)+'\x65'](global[_0x2da014(0x219)](_0x2da014(0x21a)+'\x61\x6e\x64',_0x2da014(0x1f8),reason?_0x2da014(0x1de)+reason:'',dateAdded?'\x2d\x20\x42\u1ecb\x20\x63\u1ea5\x6d\x20\x76'+'\u00e0\x6f\x3a\x20'+dateAdded:''),threadID,async(_0x34b90b,_0x1267c0)=>{return await new Promise(_0x48a785=>setTimeout(_0x48a785,(-0x6ee+-0x169*-0x1b+-0x1f20)*(0x4c2*0x8+0xece+0x1052*-0x3))),api['\x75\x6e\x73\x65\x6e\x64\x4d\x65\x73\x73'+'\x61\x67\x65'](_0x1267c0['\x6d\x65\x73\x73\x61\x67\x65\x49\x44']);},messageID);}else{if(threadBanned[_0x2da014(0x202)](threadID)){const {reason,dateAdded}=threadBanned[_0x2da014(0x21e)](threadID)||{};return api[_0x2da014(0x1d7)+'\x65'](global[_0x2da014(0x219)](_0x2da014(0x21a)+_0x2da014(0x1e9),_0x2da014(0x1f0)+'\x65\x64',reason?'\x2d\x20\x4c\u00fd\x20\x64\x6f\x3a\x20'+reason:'',dateAdded?_0x2da014(0x21c)+_0x2da014(0x1cd)+dateAdded:''),threadID,async(_0x348e6a,_0x29e6e1)=>{const _0x8b0f32=_0x2da014;return await new Promise(_0x3c9981=>setTimeout(_0x3c9981,(-0x16b8+0x24f+-0x20b*-0xa)*(-0x385*-0x1+-0x10b6+0x1119*0x1))),api[_0x8b0f32(0x203)+'\x61\x67\x65'](_0x29e6e1[_0x8b0f32(0x1e0)]);},messageID);}}}}const [matchedPrefix]=contentMessage[_0x2da014(0x20f)](prefixRegex),args=contentMessage['\x73\x6c\x69\x63\x65'](matchedPrefix['\x6c\x65\x6e\x67\x74\x68'])[_0x2da014(0x207)]()['\x73\x70\x6c\x69\x74'](/\s+/),commandName=args[_0x2da014(0x1f3)]()['\x74\x6f\x4c\x6f\x77\x65\x72\x43\x61\x73'+'\x65']();var command=commands[_0x2da014(0x21e)](commandName);if(!command){var allCommandName=[];const commandValues=commands['\x6b\x65\x79\x73']();for(const cmd of commandValues)allCommandName['\x70\x75\x73\x68'](cmd);const checker=stringSimilarity[_0x2da014(0x222)+_0x2da014(0x1ef)](commandName,allCommandName);if(checker[_0x2da014(0x1e7)][_0x2da014(0x1ea)]>=0x5b9+0x2*0xef+-0x797+0.5)command=commands[_0x2da014(0x21e)](checker['\x62\x65\x73\x74\x4d\x61\x74\x63\x68'][_0x2da014(0x209)]);else return api[_0x2da014(0x1d7)+'\x65'](global[_0x2da014(0x219)](_0x2da014(0x21a)+_0x2da014(0x1e9),_0x2da014(0x224)+_0x2da014(0x221),checker[_0x2da014(0x1e7)][_0x2da014(0x209)]),threadID);}if(commandBanned[_0x2da014(0x202)](threadID)||commandBanned[_0x2da014(0x202)](senderID)){if(!ADMINBOT[_0x2da014(0x205)](senderID)){const dataThread=commandBanned['\x67\x65\x74'](threadID)||[],dataUser=commandBanned[_0x2da014(0x21e)](senderID)||[];if(dataThread[_0x2da014(0x205)](command[_0x2da014(0x211)][_0x2da014(0x218)]))return api[_0x2da014(0x1d7)+'\x65'](global[_0x2da014(0x219)](_0x2da014(0x21a)+'\x61\x6e\x64',_0x2da014(0x1f1)+_0x2da014(0x1dc),command[_0x2da014(0x211)][_0x2da014(0x218)]),threadID,async(_0x299347,_0x5a2a2b)=>{const _0x5221b1=_0x2da014;return await new Promise(_0x40ed6a=>setTimeout(_0x40ed6a,(0x2*0xea3+-0x499*-0x1+0x26b*-0xe)*(-0x1bd+-0x1fdc*-0x1+-0x1a37))),api[_0x5221b1(0x203)+_0x5221b1(0x1e8)](_0x5a2a2b[_0x5221b1(0x1e0)]);},messageID);if(dataUser[_0x2da014(0x205)](command[_0x2da014(0x211)][_0x2da014(0x218)]))return api[_0x2da014(0x1d7)+'\x65'](global[_0x2da014(0x219)]('\x68\x61\x6e\x64\x6c\x65\x43\x6f\x6d\x6d'+_0x2da014(0x1e9),_0x2da014(0x1d1)+_0x2da014(0x200),command[_0x2da014(0x211)][_0x2da014(0x218)]),threadID,async(_0x1ea9c7,_0xbf22af)=>{const _0x26cbe8=_0x2da014;return await new Promise(_0x3fa110=>setTimeout(_0x3fa110,(0x1bfa+0x1444*-0x1+-0x7b1)*(-0xe15+-0x11*-0x1cd+0x10*-0xca))),api[_0x26cbe8(0x203)+'\x61\x67\x65'](_0xbf22af[_0x26cbe8(0x1e0)]);},messageID);}}if(command[_0x2da014(0x211)][_0x2da014(0x20a)+_0x2da014(0x220)][_0x2da014(0x204)+'\x65']()==_0x2da014(0x1fc)&&!global[_0x2da014(0x21d)][_0x2da014(0x1da)+'\x77\x4e\x53\x46\x57'][_0x2da014(0x205)](threadID)&&!ADMINBOT['\x69\x6e\x63\x6c\x75\x64\x65\x73'](senderID))return api[_0x2da014(0x1d7)+'\x65'](global[_0x2da014(0x219)](_0x2da014(0x21a)+_0x2da014(0x1e9),'\x74\x68\x72\x65\x61\x64\x4e\x6f\x74\x41'+'\x6c\x6c\x6f\x77\x4e\x53\x46\x57'),threadID,async(_0x229a4a,_0x3ee8a3)=>{const _0x196154=_0x2da014;return await new Promise(_0x2c602e=>setTimeout(_0x2c602e,(-0x10df*-0x1+0x200+-0x12da)*(-0x3bb*-0x9+0x1af0+-0x1*0x389b))),api['\x75\x6e\x73\x65\x6e\x64\x4d\x65\x73\x73'+_0x196154(0x1e8)](_0x3ee8a3[_0x196154(0x1e0)]);},messageID);var thread;if(event['\x69\x73\x47\x72\x6f\x75\x70']==!![])try{thread=threadInfo['\x67\x65\x74'](threadID);if(Object['\x6b\x65\x79\x73'](thread)[_0x2da014(0x223)]==0xfd3+0xdc4+-0x1d97)throw new Error();}catch{try{thread=await Threads['\x67\x65\x74\x49\x6e\x66\x6f'](threadID);const _0x1fb620={};_0x1fb620[_0x2da014(0x1f6)]=thread[_0x2da014(0x1f6)],_0x1fb620[_0x2da014(0x20e)]=thread[_0x2da014(0x20e)],_0x1fb620[_0x2da014(0x1e2)]=thread['\x6e\x69\x63\x6b\x6e\x61\x6d\x65\x73'];const threadInfoData=_0x1fb620,_0x386a32={};_0x386a32[_0x2da014(0x217)]=threadInfoData,await Threads[_0x2da014(0x1f7)](threadID,_0x386a32),threadInfo[_0x2da014(0x1d3)](threadID,threadInfoData);}catch(_0x162e06){logger(global['\x67\x65\x74\x54\x65\x78\x74'](_0x2da014(0x21a)+'\x61\x6e\x64',_0x2da014(0x1d8)+_0x2da014(0x208),_0x162e06),_0x2da014(0x1dd));}}var permssion=-0x1*-0x18d7+0x3f*-0x19+-0x34*0x5c;const _0x3fe852={};function _0x3063(_0x753c30,_0xa870f4){return _0x3063=function(_0x3f0679,_0x273af8){_0x3f0679=_0x3f0679-(0xee3+-0x17a9*-0x1+-0x17*0x199);let _0x5e2921=_0x2603[_0x3f0679];return _0x5e2921;},_0x3063(_0x753c30,_0xa870f4);}_0x3fe852['\x61\x64\x6d\x69\x6e\x49\x44\x73']=[];const find=(thread||_0x3fe852)[_0x2da014(0x20e)]['\x66\x69\x6e\x64'](_0x3da7bb=>_0x3da7bb['\x69\x64'][_0x2da014(0x1db)]()==senderID[_0x2da014(0x1db)]());if(ADMINBOT[_0x2da014(0x205)](senderID))permssion=-0x1*0x15fd+0x4d6+-0x17*-0xbf;else{if(!ADMINBOT[_0x2da014(0x205)](senderID['\x74\x6f\x53\x74\x72\x69\x6e\x67']())&&find)permssion=0x1cc6+-0x12*0x1ae+0xf*0x19;}if(command[_0x2da014(0x211)][_0x2da014(0x206)+'\x6f\x6e']>permssion)return api[_0x2da014(0x1d7)+'\x65'](global[_0x2da014(0x219)](_0x2da014(0x21a)+_0x2da014(0x1e9),_0x2da014(0x1d4)+'\x6f\x74\x45\x6e\x6f\x75\x67\x68',command[_0x2da014(0x211)][_0x2da014(0x218)]),threadID,messageID);if(!cooldowns[_0x2da014(0x202)](command['\x63\x6f\x6e\x66\x69\x67']['\x6e\x61\x6d\x65']))cooldowns['\x73\x65\x74'](command[_0x2da014(0x211)][_0x2da014(0x218)],new Map());const timestamps=cooldowns['\x67\x65\x74'](command[_0x2da014(0x211)]['\x6e\x61\x6d\x65']),cooldownAmount=(command[_0x2da014(0x211)]['\x63\x6f\x6f\x6c\x64\x6f\x77\x6e\x73']||0xdb*0x27+-0x15*-0xeb+0x37*-0xf5)*(0xb7*-0xb+0xd5c+-0xb*0x25);if(timestamps[_0x2da014(0x202)](senderID)&&dateNow<timestamps[_0x2da014(0x21e)](senderID)+cooldownAmount)return api[_0x2da014(0x210)+_0x2da014(0x21b)]('\u23f1',event[_0x2da014(0x1e0)],_0x5af87d=>_0x5af87d?logger(global['\x67\x65\x74\x54\x65\x78\x74'](_0x2da014(0x21a)+_0x2da014(0x1e9),'\x70\x65\x72\x6d\x73\x73\x69\x6f\x6e\x4e'+_0x2da014(0x21f),error),_0x2da014(0x1dd)):'',!![]);if(command[_0x2da014(0x216)]&&typeof command[_0x2da014(0x216)]=='\x6f\x62\x6a\x65\x63\x74'&&command[_0x2da014(0x216)][_0x2da014(0x1e3)+_0x2da014(0x1ce)](global[_0x2da014(0x211)]['\x6c\x61\x6e\x67\x75\x61\x67\x65'])){function getText(..._0x50dbec){const _0x5e21b0=_0x2da014;var _0x339a1b=command[_0x5e21b0(0x216)][global[_0x5e21b0(0x211)][_0x5e21b0(0x1f5)]][_0x50dbec[0x1*-0x1434+0x1eea+-0xab6]]||'';for(var _0x5c77a3=_0x50dbec[_0x5e21b0(0x223)];_0x5c77a3>-0x9*0x211+0x5*-0x717+0x3*0x1204;_0x5c77a3--){const _0x513305=RegExp('\x25'+_0x5c77a3,'\x67');_0x339a1b=_0x339a1b[_0x5e21b0(0x1f4)](_0x513305,_0x50dbec[_0x5c77a3]);}return _0x339a1b;}}else{function getText(){}};try{const _0x57a269={};_0x57a269[_0x2da014(0x213)]=api,_0x57a269[_0x2da014(0x1ec)]=event,_0x57a269[_0x2da014(0x1eb)]=args,_0x57a269[_0x2da014(0x1e6)]=models,_0x57a269[_0x2da014(0x1fb)]=Users,_0x57a269[_0x2da014(0x1cf)]=Threads,_0x57a269[_0x2da014(0x20c)]=Currencies,_0x57a269['\x70\x65\x72\x6d\x73\x73\x69\x6f\x6e']=permssion,_0x57a269[_0x2da014(0x219)]=getText,command[_0x2da014(0x1df)](_0x57a269),timestamps[_0x2da014(0x1d3)](senderID,dateNow);if(DeveloperMode==!![])logger(global[_0x2da014(0x219)]('\x68\x61\x6e\x64\x6c\x65\x43\x6f\x6d\x6d'+_0x2da014(0x1e9),'\x65\x78\x65\x63\x75\x74\x65\x43\x6f\x6d'+_0x2da014(0x1d0),time,commandName,senderID,threadID,args[_0x2da014(0x1d6)]('\x20'),Date[_0x2da014(0x1f2)]()-dateNow),'\x5b\x20\x44\x45\x56\x20\x4d\x4f\x44\x45'+'\x20\x5d');return;}catch(_0x6b1065){return logger(global['\x67\x65\x74\x54\x65\x78\x74'](_0x2da014(0x21a)+'\x61\x6e\x64','\x63\x6f\x6d\x6d\x61\x6e\x64\x45\x72\x72'+'\x6f\x72',command[_0x2da014(0x211)]['\x6e\x61\x6d\x65'],_0x6b1065),'\x65\x72\x72\x6f\x72'),api[_0x2da014(0x1d7)+'\x65'](global['\x67\x65\x74\x54\x65\x78\x74']('\x68\x61\x6e\x64\x6c\x65\x43\x6f\x6d\x6d'+'\x61\x6e\x64','\x63\x6f\x6d\x6d\x61\x6e\x64\x45\x72\x72'+'\x6f\x72',command[_0x2da014(0x211)][_0x2da014(0x218)],_0x6b1065),threadID);}
	};
};